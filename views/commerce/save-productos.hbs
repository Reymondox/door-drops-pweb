<div class="container my-5">
  <div class="card shadow-sm border-0">
    <div class="card-body p-4">
      <h2 class="fw-bold mb-4 text-primary">
        <i class="bi bi-bag-check me-2"></i>
        {{#if editMode}}Editar Producto: {{producto.name}}{{else}}Crear nuevo Producto{{/if}}
      </h2>

      <form action="{{#if editMode}}/commerce/productos/edit{{else}}/commerce/productos/create{{/if}}" 
      method="POST" 
      enctype="multipart/form-data">

        <!-- Nombre -->
        <div class="mb-3">
          <label for="name" class="form-label fw-semibold">
            <i class="bi bi-type me-1"></i>Nombre del Producto
          </label>
          <input
            type="text"
            class="form-control shadow-sm"
            id="name"
            name="name"
            placeholder="Ej: Laptop HP 14''"
            required
            value="{{#if editMode}}{{producto.name}}{{/if}}"
          >
        </div>

      
  <!-- Imagen -->
  <!-- Input oculto para indicar a Multer que es imagen de producto -->
<input type="hidden" name="imageType" value="productImg">

<!-- Selector de imagen -->
<div class="mb-3">
  <label for="imageFile" class="form-label fw-semibold">
    <i class="bi bi-image me-1"></i>Seleccionar imagen
  </label>
  <input
    type="file"
    class="form-control shadow-sm"
    id="imageFile"
    name="imageFile"
    accept="image/*"
    {{#unless editMode}}required{{/unless}}
  >

  <!-- Mostrar imagen actual si estamos en modo edición -->
  {{#if editMode}}
    <div class="mt-2">
      <p class="mb-1 fw-light text-muted">Imagen actual:</p>
      <img src="{{producto.imageUrl}}" alt="Imagen actual" class="img-thumbnail" style="max-height: 120px;">
    </div>
  {{/if}}
</div>

        <!-- Descripción -->
        <div class="mb-3">
          <label for="description" class="form-label fw-semibold">
            <i class="bi bi-card-text me-1"></i>Descripción
          </label>
          <textarea
            id="description"
            name="description"
            class="form-control shadow-sm"
            rows="3"
            placeholder="Ej: Laptop ligera, procesador i5, 8GB RAM"
            required
          >{{#if editMode}}{{producto.description}}{{/if}}</textarea>
        </div>

        <!-- Precio -->
        <div class="mb-3">
          <label for="price" class="form-label fw-semibold">
            <i class="bi bi-currency-dollar me-1"></i>Precio
          </label>
          <input
            type="number"
            step="0.01"
            class="form-control shadow-sm"
            id="price"
            name="price"
            placeholder="Ej: 550.00"
            required
            value="{{#if editMode}}{{producto.price}}{{/if}}"
          />
        </div>

        <!-- Categoría -->
        <div class="mb-4">
          <label for="categorieId" class="form-label fw-semibold">
            <i class="bi bi-tags me-1"></i>Categoría
          </label>
          <select id="categorieId" name="categorieId" class="form-select shadow-sm" required>
            <option value="">-- Selecciona una categoría --</option>
            {{#each categoriasList}}
              <option value="{{this.id}}" {{#if (eq this.id ../producto.categorieId)}}selected{{/if}}>
                {{this.name}}
              </option>
            {{/each}}
          </select>
        </div>

        {{#if editMode}}
          {{!-- <input type="hidden" name="productosId" value="{{producto.id}}" /> --}}
          <input type="hidden" name="productId" value="{{producto.id}}" />
        {{/if}}

        <!-- Botones -->
        <div class="d-flex justify-content-between">
          <a href="/commerce/productos" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Volver
          </a>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-check-circle"></i>
            {{#if editMode}}Actualizar{{else}}Crear{{/if}}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
