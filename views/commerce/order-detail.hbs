{{!-- views/commerce/order-detail.hbs --}}
<section class="py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h2 class="mb-0">Pedido #{{order.id}}</h2>
    <a href="/commerce/home" class="btn btn-outline-secondary btn-sm">← Volver</a>
  </div>

  <div class="mb-3">
    <img src="{{user.imageUrl}}" alt="logo" style="height:40px" class="me-2">
    <strong>{{user.profileName}}</strong>
    <span class="badge ms-2
      {{#ifeq order.status 'PENDING'}}text-bg-warning{{else}}
        {{#ifeq order.status 'IN_PROCESS'}}text-bg-info{{else}}text-bg-success{{/ifeq}}
      {{/ifeq}}">
      {{order.status}}
    </span>
  </div>

  <p class="text-muted mb-1">Fecha: {{order.orderedAt}}</p>
  <p class="mb-3 fw-bold">Total: RD$ {{order.totalPrice}}</p>

  <div class="list-group">
    {{#each order.products}}
      <div class="list-group-item d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
          <img src="{{this.imageUrl}}" class="rounded me-3" style="width:50px;height:50px;object-fit:cover;">
          <div>
            <div class="fw-semibold">{{this.name}}</div>
            <small class="text-muted">Cant: {{this.quantity}} • Unit: RD$ {{this.unitPrice}}</small>
          </div>
        </div>
        <div class="fw-bold">RD$ {{this.lineTotal}}</div>
      </div>
    {{/each}}
  </div>

  {{!-- Si el pedido está PENDING, botón para asignar delivery --}}
  {{#ifeq order.status 'PENDING'}}
    <form method="post" action="/commerce/orders/assign-delivery" class="mt-3">
      <input type="hidden" name="orderId" value="{{../order.id}}">
      <button class="btn btn-primary">Asignar delivery</button>
    </form>
  {{/ifeq}}
</section>
